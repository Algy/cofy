<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cofy Lisp Interpreter in JavaScript</title>
  <style>
    html, body { margin: 0; padding: 0; }
    body { font: 12px Arial, sans-serif; background: #AAA; color: #000; padding: 20px; }
    #input { width: 100%; height: 350px; font: 12px monospace; }
    #output { background: #EEE; padding: 10px; margin: 10px 0 0; font: 12px monospace; }
    small { color: #48F; }
    i { color: #C00; }
  </style>
</head>
<body>
  <div><textarea id="input">(def inc (fn (n) (+ n 1)))
(def map
     (fn (f x)
         (if (= x ())
             ()
             (cons (f (first x))
                   (map f (rest x))))))

(map inc '(1 2 3))</textarea></div>
  <input type="button" value="Evaluate" onclick="read_eval_print(document.getElementById('input').value)">
  <div id="output"><b>Output Window</b><br></div>
  <script src="../lang/core.js"></script>
  <script>
    var OUT = (function() {
      var attempt = 1, out = document.getElementById('output');

      function html_encode (s) {
        return s.replace(/&/g, '&amp;').replace(/</g, '&lt;');
      };

      return {
        display: function (s) {
          out.innerHTML += '<small>' + attempt++ + '</small> ' + html_encode(s) + '<br>';
        },
        error: function (e) {
          out.innerHTML += '<i>' + e.name + ": " + e.message  + '</i><br>';
        }
      };
    }());

    function read_eval_print(s) {
      try {
        OUT.display(COFY.clean_read_eval_print(s));
      } catch (e) {
        OUT.error(e);
      }
    }
  </script>
</body>
</html>

