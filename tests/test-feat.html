<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Feat.js - JavaScript Persistent Data Structure Test</title>
  <style>
    html, body { margin: 0; padding: 0; }
    body { font: 12px Arial, sans-serif; background: #FFF; color: #000; padding: 20px; }
    #result { padding: 3px 10px; }
    #log { padding: 10px; font-family: monospace; }
  </style>
  <script>
    var tests = (function (nil) {
      'use strict';
      return {
        test_create_empty: function () {
          this.isSame(FEAT.map().count(), 0);
          this.isSame(FEAT.map({}).count(), 0);
        },
        test_create_from_object: function () {
          var map = FEAT.map({a: 1, b: 2, c: 3});
          this.isSame(map.count(), 3);
          this.isSame(map.get('a'), 1);
          this.isSame(map.get('b'), 2);
          this.isSame(map.get('c'), 3);
        },
        test_get: function () {
          var map = FEAT.map({a: 1, b: 2});
          this.isSame(map.get('a'), 1);
          this.isSame(map.get('b'), 2);
          this.isUndefined(map.get('c'));
          this.isSame(map.get('c', 3), 3);
        },
        test_contains: function () {
          var map = FEAT.map({a: 1, b: 2});
          this.isTrue(map.contains('a'));
          this.isTrue(map.contains('b'));
          this.isFalse(map.contains('c'));
        },
        test_add_items: function () {
          var i, a = ['y', 'a', 'c', 'z', 'b', 'x'];
          var map1 = FEAT.map();
          var map2 = map1;
          for (i = 0; i < a.length; i++)
            map2 = map2.assoc(a[i], i + 1);
          this.isSame(map1.count(), 0);
          this.isSame(map2.count(), a.length);
          for (i = 0; i < a.length; i++)
            this.isSame(map2.get(a[i]), i + 1);
        },
        test_remove_items: function () {
          var i, a = ['c', 'z', 'y', 'a', 'x', 'b'];
          var map1 = FEAT.map();
          for (i = 0; i < a.length; i++)
            map1 = map1.assoc(a[i], i + 1);
          var map2 = map1;
          for (i = 0; i < a.length; i++)
            map2 = map2.dissoc(a[i]);
          this.isSame(map1.count(), a.length);
          this.isSame(map2.count(), 0);
          for (i = 0; i < a.length; i++)
            this.isUndefined(map2.get(a[i]));
        }
      };
    }());
  </script>
</head>
<body onload="run()">
  <div id="result"></div>
  <div id="log"></div>
  <script src="../tools/test.js"></script>
  <script src="../lang/feat.js"></script>
  <script>
    function run() {
      'use strict';
      var result = document.getElementById('result');
      var log = document.getElementById('log');
      TEST.init(result, log)(tests);
    }
  </script>
</body>
</html>

